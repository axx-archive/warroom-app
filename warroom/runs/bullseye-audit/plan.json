{
  "runId": "bullseye-audit-001",
  "runSlug": "bullseye-audit",
  "runDir": "/Users/ajhart/.openclaw/workspace/warroom/runs/bullseye-audit",
  "createdAt": "2026-02-03T12:00:00Z",
  "startMode": "claude_code_import",
  "repo": {
    "name": "bullseye",
    "path": "/Users/ajhart/Desktop/bullseye"
  },
  "goal": "Comprehensive reliability, execution resilience, and UX overhaul for Bullseye based on full audit assessment. Fix transient-provider fragility (529/429 errors), implement proper rate limiting, add retry/backoff, improve SSE resilience, and enhance UX with proper error states and partial results handling.",
  "workstream": "audit_implementation",
  "integrationBranch": "warroom/integration/bullseye-audit",
  "lanes": [
    {
      "laneId": "lane-1-review",
      "agent": "staff-engineer-reviewer",
      "branch": "warroom/bullseye-audit/staff-review",
      "worktreePath": "/Users/ajhart/.openclaw/workspace/warroom/worktrees/bullseye-audit/staff-review",
      "dependsOn": [],
      "autonomy": false,
      "scope": "Review the audit plan and proposed fixes. Identify edge cases, gaps, and risks before implementation begins.",
      "deliverables": [
        "Review rate limiter redesign for race conditions and edge cases",
        "Validate retry/backoff approach covers all failure modes",
        "Assess SSE timeout changes for unintended side effects",
        "Confirm lane structure will avoid merge conflicts",
        "Document any additional considerations for implementers"
      ],
      "allowedPaths": [
        "src/lib/**",
        "src/app/api/**",
        "docs/**"
      ],
      "verify": [
        "Review document produced with findings and recommendations"
      ]
    },
    {
      "laneId": "lane-2-reliability",
      "agent": "developer",
      "branch": "warroom/bullseye-audit/reliability",
      "worktreePath": "/Users/ajhart/.openclaw/workspace/warroom/worktrees/bullseye-audit/reliability",
      "dependsOn": ["lane-1-review"],
      "autonomy": false,
      "scope": "P0 Reliability fixes: Rate limiter rewrite, retry/backoff infrastructure, structured errors, fallback models, concurrency control.",
      "deliverables": [
        "Rewrite rate limiter with atomic acquire(), reservationId pattern, output token gating",
        "Create src/lib/anthropic/retry.ts with exponential backoff, jitter, Retry-After support",
        "Create src/lib/anthropic/errors.ts with structured error types",
        "Implement fallback model chain (Opus -> Sonnet -> Haiku)",
        "Replace Promise.all with p-limit concurrency pool (2 concurrent)",
        "Allow partial success in runParallelReaderAnalysis()"
      ],
      "allowedPaths": [
        "src/lib/rate-limiter.ts",
        "src/lib/anthropic/**",
        "src/lib/agents/index.ts",
        "src/lib/agents/types.ts"
      ],
      "verify": [
        "npm run typecheck",
        "npm run lint",
        "Rate limiter unit tests pass",
        "Retry wrapper unit tests pass"
      ]
    },
    {
      "laneId": "lane-3-sse",
      "agent": "developer",
      "branch": "warroom/bullseye-audit/sse-resilience",
      "worktreePath": "/Users/ajhart/.openclaw/workspace/warroom/worktrees/bullseye-audit/sse-resilience",
      "dependsOn": ["lane-2-reliability"],
      "autonomy": false,
      "scope": "P1 SSE/Execution resilience: Scout timeout logic, client reconnection, keepalive events, overload status events.",
      "deliverables": [
        "Switch Scout from 'first token' timeout to 'no activity' timeout",
        "Add periodic keepalive/ping SSE events",
        "Emit { type:'status', status:'overloaded', retryAfterMs } instead of terminal errors",
        "Implement client SSE reconnection with backoff in event-router.ts",
        "Preserve partial transcript on reconnection",
        "Add graceful 'paused, retrying' state"
      ],
      "allowedPaths": [
        "src/app/api/scout/route.ts",
        "src/app/api/reader-chat/route.ts",
        "src/lib/agent-sdk/event-router.ts",
        "src/lib/agent-sdk/types.ts"
      ],
      "verify": [
        "npm run typecheck",
        "npm run lint",
        "SSE keepalive events emitted",
        "Reconnection logic handles network interruption"
      ]
    },
    {
      "laneId": "lane-4-ux",
      "agent": "developer",
      "branch": "warroom/bullseye-audit/ux-improvements",
      "worktreePath": "/Users/ajhart/.openclaw/workspace/warroom/worktrees/bullseye-audit/ux-improvements",
      "dependsOn": ["lane-2-reliability"],
      "autonomy": false,
      "scope": "P1/P2 UX improvements: Scout run status surface, error classification UI, partial results, upload flow, visual hierarchy.",
      "skills": ["frontend-design"],
      "deliverables": [
        "Scout run timeline UI: Queued -> Running -> Retrying -> Partial -> Complete",
        "Human-readable error messages with expandable Details",
        "Error classification UI: 529 overload, auth errors, local crashes",
        "Partial results populate downstream tabs (Coverage/Focus/Pitch)",
        "Each tab offers 'Run missing analysis' or 'Retry failed step'",
        "Drag-and-drop upload zone always visible with file/size text",
        "Scout readers as cards with status pill, timestamp, retry action",
        "Token/time estimate display for 'Run reader evaluation'"
      ],
      "allowedPaths": [
        "src/components/**",
        "src/app/(dashboard)/**",
        "src/stores/**",
        "src/lib/errors.ts"
      ],
      "verify": [
        "npm run typecheck",
        "npm run lint",
        "Error states render correctly",
        "Partial results visible in downstream tabs"
      ]
    },
    {
      "laneId": "lane-5-qa",
      "agent": "qa-tester",
      "branch": "warroom/bullseye-audit/qa-verification",
      "worktreePath": "/Users/ajhart/.openclaw/workspace/warroom/worktrees/bullseye-audit/qa-verification",
      "dependsOn": ["lane-2-reliability", "lane-3-sse", "lane-4-ux"],
      "autonomy": false,
      "scope": "End-to-end verification: Simulate error conditions, test partial results, SSE reconnection, rate limiting behavior.",
      "deliverables": [
        "Test 529/429 error handling and retry behavior",
        "Test partial reader results with 1 of 3 failing",
        "Test SSE reconnection after network interruption",
        "Test rate limiter under concurrent load",
        "Test error UI copy for all error classifications",
        "Test upload flow edge cases",
        "Regression test existing functionality"
      ],
      "allowedPaths": [
        "src/**",
        "tests/**",
        "__tests__/**"
      ],
      "verify": [
        "npm run test",
        "All error scenarios handled gracefully",
        "No regressions in existing functionality"
      ]
    }
  ],
  "merge": {
    "proposedOrder": [
      "lane-1-review",
      "lane-2-reliability",
      "lane-3-sse",
      "lane-4-ux",
      "lane-5-qa"
    ],
    "method": "sequential",
    "notes": "lane-2 creates shared error types and retry infrastructure that lane-3 and lane-4 depend on. lane-3 and lane-4 can potentially run in parallel after lane-2 completes since they touch different file scopes. lane-5 must run last to verify all changes.",
    "requiresHuman": true,
    "conflictRisk": {
      "lane-2-reliability": {
        "risk": "low",
        "sharedFiles": ["src/lib/agents/index.ts"]
      },
      "lane-3-sse": {
        "risk": "low",
        "sharedFiles": []
      },
      "lane-4-ux": {
        "risk": "low",
        "sharedFiles": ["src/lib/errors.ts"]
      }
    }
  },
  "context": {
    "auditSource": "Full reliability + UX + ops audit",
    "priority": "P0 reliability first, then P1 SSE, then P1/P2 UX",
    "keyFiles": {
      "rateLimiter": "src/lib/rate-limiter.ts",
      "agents": "src/lib/agents/index.ts",
      "scoutRoute": "src/app/api/scout/route.ts",
      "readerChatRoute": "src/app/api/reader-chat/route.ts",
      "eventRouter": "src/lib/agent-sdk/event-router.ts",
      "scoutView": "src/components/scout/scout-view.tsx",
      "chatInterface": "src/components/chat/chat-interface.tsx"
    },
    "techStack": {
      "framework": "Next.js 16 (App Router, Turbopack)",
      "database": "PostgreSQL + Supabase + Prisma 7",
      "ai": "Claude Agent SDK + Anthropic API (Opus 4.5)",
      "ui": "Tailwind CSS 4, shadcn/ui, Framer Motion"
    }
  }
}
